{"version":3,"file":"src_views_payment_Card_jsx.js","mappings":"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","sources":["webpack://orb-services/./src/utils/DisplayStatus.js","webpack://orb-services/./src/views/payment/Card.jsx","webpack://orb-services/./src/views/payment/Navigation.jsx"],"sourcesContent":["export const displayStatus = (status) => {\n\n  if (status === \"requires_payment_method\") {\n    return 'Choose a payment method'\n  }\n\n  if (status === 'succeeded') {\n    return 'Your transaction was successful. Thank you. ';\n  }\n\n  if (status === 'processing') {\n    return `This transaction is currently processing you may revisit this page at a later time for an update and a confirmation email will be sent.`;\n  }\n\n  if (\n    status === 'requires_confirmation' ||\n    status === 'requires_action' ||\n    status === 'requires_capture'\n  ) {\n  }\n\n  if (status === 'canceled') {\n    return 'This transaction has been canceled';\n  }\n\n  return status;\n};\n\nexport const displayStatusType = (status) => {\n  if (status === 'succeeded') {\n    return 'success';\n  }\n\n  if (\n    status === 'processing' ||\n    status === 'requires_confirmation' ||\n    status === 'requires_action' ||\n    status === 'requires_capture'\n  ) {\n    return 'caution';\n  }\n\n  if (status === 'canceled') {\n    return 'error';\n  }\n\n  return status;\n};\n","import { useEffect, useState } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { useSelector, useDispatch } from 'react-redux';\n\nimport PaymentNavigationComponent from './Navigation';\n\nimport { getClient } from '../../controllers/clientSlice';\nimport {\n  getInvoice,\n  getStripeInvoice,\n  updateInvoiceStatus,\n} from '../../controllers/invoiceSlice';\nimport { getPaymentIntent } from '../../controllers/paymentSlice';\nimport {\n  postReceipt,\n  getPaymentMethod,\n  updatePaymentMethod,\n} from '../../controllers/receiptSlice';\n\nimport { displayStatus, displayStatusType } from '../../utils/DisplayStatus';\n\n// Stripe\nimport { CardElement, useStripe, useElements } from '@stripe/react-stripe-js';\n\nconst CardPaymentComponent = () => {\n  const { id } = useParams();\n\n  const { first_name, last_name, stripe_customer_id } = useSelector((state) => state.client);\n  const { stripe_invoice_id, status, amount_paid, remaining_balance } =\n    useSelector((state) => state.invoice);\n  const { loading, error, client_secret, payment_intent_id } = useSelector(\n    (state) => state.payment\n  );\n  const { receipt_id, payment_method, brand, last4 } = useSelector(\n    (state) => state.receipt\n  );\n\n  const [messageType, setMessageType] = useState('');\n  const [message, setMessage] = useState('Choose a payment method');\n\n  // Setup so card displays input\n  const [cardNumber, setCardNumber] = useState('');\n  const [validThruMonth, setValidThruMonth] = useState('');\n  const [validThruYear, setValidThruYear] = useState('');\n  const [CVC, setCVC] = useState('');\n\n  const [paymentMethodID, setPaymentMethodID] = useState('');\n\n  const dispatch = useDispatch();\n  const navigate = useNavigate();\n\n  const stripe = useStripe();\n  const elements = useElements();\n\n  const user_email = sessionStorage.getItem('user_email');\n\n  useEffect(() => {\n    if (user_email) {\n      dispatch(getClient(user_email));\n    }\n  }, [dispatch, user_email]);\n\n  useEffect(() => {\n    if (stripe_customer_id) {\n      dispatch(getInvoice(id, stripe_customer_id));\n    }\n  }, [dispatch, id, stripe_customer_id]);\n\n  useEffect(() => {\n    if (stripe_invoice_id) {\n      dispatch(getStripeInvoice());\n    }\n  }, [dispatch, stripe_invoice_id]);\n\n  useEffect(() => {\n    if (payment_intent_id) {\n      dispatch(getPaymentIntent(payment_intent_id));\n    }\n  }, [dispatch, payment_intent_id]);\n\n  useEffect(() => {\n    if (status) {\n      dispatch(updateInvoiceStatus());\n    }\n  }, [dispatch, status]);\n\n  useEffect(() => {\n    if (status) {\n      setMessage(displayStatus(status));\n      setMessageType(displayStatusType(status));\n    }\n  }, [status]);\n\n  useEffect(() => {\n    if (receipt_id) {\n      navigate(`/services/receipt/${receipt_id}`);\n    }\n  }, [receipt_id, navigate]);\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n    if (!stripe || !elements) {\n      return;\n    }\n\n    const result = await stripe.confirmCardPayment(client_secret, {\n      payment_method: {\n        card: elements.getElement(CardElement),\n      },\n    });\n\n    if (result.error) {\n      setMessage(result.error.message);\n      setMessageType('error');\n    }\n\n    if (result.paymentIntent) {\n      let status = result.paymentIntent.status;\n\n      setMessage(displayStatus(status));\n      setMessageType(displayStatusType(status));\n\n      dispatch(getPaymentMethod(result.paymentIntent.payment_method));\n    }\n  };\n\n  useEffect(() => {\n    if (brand !== '' && last4 !== '') {\n      const paymentMethodCard = `${brand} - ${last4}`;\n      dispatch(updatePaymentMethod(paymentMethodCard));\n    }\n  }, [dispatch, brand, last4]);\n\n  useEffect(() => {\n    if (payment_method) {\n      dispatch(getStripeInvoice());\n    }\n  }, [dispatch, payment_method]);\n\n  useEffect(() => {\n    if (status === 'paid') {\n      dispatch(postReceipt());\n    }\n  }, [dispatch, status]);\n\n  if (error) {\n    return <div>Error: {error}</div>;\n  }\n\n  if (loading) {\n    return <div>Loading...</div>;\n  }\n\n  return (\n    <>\n      <PaymentNavigationComponent />\n      <div className=\"debit-credit-card card\">\n        <div className=\"front\">\n          n{' '}\n          <div className=\"image\">\n            <img src=\"\" alt=\"\" />\n            <img src=\"\" alt=\"\" />\n          </div>\n          <div className=\"card-number-box\">\n            {cardNumber ? cardNumber : '#### #### #### ####'}\n          </div>\n          <div className=\"flexbox\">\n            <div className=\"box\">\n              <div className=\"card-holder-name\">\n                {first_name} {last_name}\n              </div>\n            </div>\n\n            <div className=\"box\">\n              <span>VALID THRU</span>\n              <div className=\"expiration\">\n                <span className=\"exp-month\">Month</span> /\n                <span className=\"exp-year\">Year</span>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"back\">\n          <div className=\"box\">\n            <span>cvv</span>\n            <div className=\"cvv-box\"></div>\n            <img src=\"\" alt=\"\" />\n          </div>\n        </div>\n      </div>\n\n      <form className=\"stripe-card card\" onSubmit={handleSubmit}>\n        <CardElement />\n      </form>\n\n      {message && (\n        <div className=\"status-bar card\">\n          <span className={`${messageType}`}>{message}</span>\n        </div>\n      )}\n\n      <button type=\"submit\" disabled={!stripe} onClick={handleSubmit}>\n        <h3>PAY</h3>\n      </button>\n    </>\n  );\n};\n\nexport default CardPaymentComponent;\n","import { NavLink } from 'react-router-dom';\nimport {\n  useNavigate,\n  useParams,\n} from 'react-router-dom';\n\nfunction PaymentNavigationComponent() {\n  const { id } = useParams();\n\n  return (\n    <>\n      <h2 className=\"title\">PAYMENT</h2>\n      <div className=\"payment-options\">\n        <NavLink to={`/services/payment/${id}/mobile`}>\n          <button className=\"mobile-btn\" id=\"mobile-btn\">\n            <h4>MOBILE</h4>\n          </button>\n        </NavLink>\n\n        <NavLink to={`/services/payment/${id}/card`}>\n          <button className=\"debit-credit-btn\" id=\"debit-credit-btn\">\n            <h4>CARD</h4>\n          </button>\n        </NavLink>\n      </div>\n    </>\n  );\n}\n\nexport default PaymentNavigationComponent;\n"],"names":["displayStatus","status","displayStatusType","useEffect","useState","useParams","useNavigate","useSelector","useDispatch","PaymentNavigationComponent","getClient","getInvoice","getStripeInvoice","updateInvoiceStatus","getPaymentIntent","postReceipt","getPaymentMethod","updatePaymentMethod","CardElement","useStripe","useElements","CardPaymentComponent","id","first_name","last_name","stripe_customer_id","state","client","stripe_invoice_id","amount_paid","remaining_balance","invoice","loading","error","client_secret","payment_intent_id","payment","receipt_id","payment_method","brand","last4","receipt","messageType","setMessageType","message","setMessage","cardNumber","setCardNumber","validThruMonth","setValidThruMonth","validThruYear","setValidThruYear","CVC","setCVC","paymentMethodID","setPaymentMethodID","dispatch","navigate","stripe","elements","user_email","sessionStorage","getItem","handleSubmit","event","preventDefault","result","confirmCardPayment","card","getElement","paymentIntent","paymentMethodCard","createElement","Fragment","className","src","alt","onSubmit","type","disabled","onClick","NavLink","to"],"sourceRoot":""}