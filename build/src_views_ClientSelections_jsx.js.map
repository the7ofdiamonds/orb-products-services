{"version":3,"file":"src_views_ClientSelections_jsx.js","mappings":"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","sources":["webpack://orb-services/./src/loading/LoadingComponent.jsx","webpack://orb-services/./src/views/ClientSelections.jsx","webpack://orb-services/./src/views/components/StatusBar.jsx"],"sourcesContent":["function LoadingComponent() {\n  return <div>Loading...</div>;\n}\n\nexport default LoadingComponent;","import React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useSelector, useDispatch } from 'react-redux';\n\nimport { fetchServices } from '../controllers/servicesSlice.js';\nimport { getClient } from '../controllers/clientSlice.js';\nimport {\n  addSelections,\n  calculateSelections,\n  createQuote,\n  finalizeQuote,\n  getClientQuotes,\n} from '../controllers/quoteSlice.js';\n\nimport LoadingComponent from '../loading/LoadingComponent';\nimport StatusBar from '../views/components/StatusBar';\n\nfunction SelectionsComponent() {\n  const dispatch = useDispatch();\n\n  const [messageType, setMessageType] = useState('info');\n  const [message, setMessage] = useState(\n    'Check the boxes next to the services you would like performed.'\n  );\n  const [checkedItems, setCheckedItems] = useState([]);\n\n  const { servicesLoading, services } = useSelector((state) => state.services);\n  const { user_email, stripe_customer_id } = useSelector(\n    (state) => state.client\n  );\n  const {\n    loading,\n    quotes,\n    quoteError,\n    quote_id,\n    status,\n    selections,\n    total,\n    stripe_quote_id,\n  } = useSelector((state) => state.quote);\n\n  useEffect(() => {\n    if (user_email) {\n      dispatch(getClient()).then((response) => {\n        if (response.error !== undefined) {\n          console.error(response.error.message);\n          setMessageType('error');\n          setMessage(response.error.message);\n        }\n      });\n    }\n  }, [user_email, dispatch]);\n\n  useEffect(() => {\n    if (stripe_customer_id) {\n      dispatch(getClientQuotes()).then((response) => {\n        if (response.error !== undefined) {\n          console.error(response.error.message);\n          setMessageType('error');\n          setMessage(response.error.message);\n        }\n      });\n    }\n  }, [stripe_customer_id, dispatch]);\n\n  useEffect(() => {\n    if (quotes) {\n      for (let i = 0; i < quotes.length; i++) {\n        const timestampNow = Math.floor(Date.now() / 1000);\n        const timestamp = parseInt(quotes[i].expires_at);\n        const createdAt = quotes[i].createdAt;\n        const expiresAt = new Date(timestamp * 1000);\n\n        if (timestampNow < timestamp) {\n          console.log(`${createdAt} - ${expiresAt} ${quotes[i].id}`);\n          console.log('Time has passed for quote');\n        } else {\n          console.log(`${createdAt} - ${expiresAt} ${quotes[i].id}`);\n          console.log('Time has not passed for quote');\n        }\n      }\n    }\n  }, [quotes]);\n\n  useEffect(() => {\n    if (stripe_customer_id) {\n      dispatch(fetchServices()).then((response) => {\n        if (response.error !== undefined) {\n          console.error(response.error.message);\n          setMessageType('error');\n          setMessage(response.error.message);\n        }\n      });\n    }\n  }, [stripe_customer_id, dispatch]);\n\n  useEffect(() => {\n    dispatch(addSelections(checkedItems));\n  }, [dispatch, checkedItems]);\n\n  useEffect(() => {\n    dispatch(calculateSelections(services.cost));\n  }, [dispatch, services.cost, checkedItems]);\n\n  const handleCheckboxChange = (event, id, price_id, description, cost) => {\n    const isChecked = event.target.checked;\n\n    setCheckedItems((prevItems) => {\n      if (isChecked) {\n        const newItem = { id, price_id, description, cost };\n        return [...prevItems, newItem];\n      } else {\n        return prevItems.filter((item) => item.id !== id);\n      }\n    });\n  };\n\n  const handleClick = () => {\n    if (selections.length > 0 && stripe_customer_id) {\n      dispatch(createQuote(selections)).then((response) => {\n        if (response.error !== undefined) {\n          console.error(response.error.message);\n          setMessageType('error');\n          setMessage(response.error.message);\n        }\n      });\n    } else {\n      setMessageType('error');\n    }\n  };\n\n  useEffect(() => {\n    if (stripe_quote_id) {\n      dispatch(finalizeQuote()).then((response) => {\n        if (response.error !== undefined) {\n          console.error(response.error.message);\n          setMessageType('error');\n          setMessage(response.error.message);\n        }\n      });\n    }\n  }, [stripe_quote_id, dispatch]);\n\n  useEffect(() => {\n    if (quote_id && (status === 'open' || status === 'accepted')) {\n      window.location.href = `/billing/quote/${quote_id}`;\n    }\n  }, [quote_id, status]);\n\n  if (servicesLoading) {\n    return <LoadingComponent />;\n  }\n\n  return (\n    <>\n      <h2>SELECTIONS</h2>\n\n      <div className=\"quote-card card\">\n        <table>\n          <thead>\n            <tr>\n              <th colSpan={2}>\n                <h4 className=\"description-label\">DESCRIPTION</h4>\n              </th>\n              <th>\n                <h4 className=\"cost-label\">COST</h4>\n              </th>\n            </tr>\n          </thead>\n          <tbody>\n            {services && services.length ? (\n              <React.Fragment>\n                {services.map((service) => {\n                  const { id, price_id, description, cost } = service;\n\n                  return (\n                    <tr key={price_id} id=\"quote_option\">\n                      <td>\n                        <input\n                          className=\"input selection feature-selection\"\n                          type=\"checkbox\"\n                          name=\"quote[checkbox][]\"\n                          checked={checkedItems.some(\n                            (item) => item.price_id === price_id\n                          )}\n                          onChange={(event) =>\n                            handleCheckboxChange(\n                              event,\n                              id,\n                              price_id,\n                              description,\n                              cost\n                            )\n                          }\n                        />\n                      </td>\n                      <td className=\"feature-description\">{description}</td>\n                      <td\n                        className=\"feature-cost table-number\"\n                        id=\"feature_cost\">\n                        {new Intl.NumberFormat('us', {\n                          style: 'currency',\n                          currency: 'USD',\n                        }).format(cost)}\n                      </td>\n                    </tr>\n                  );\n                })}\n              </React.Fragment>\n            ) : (\n              <tr>\n                <td colSpan={3}>\n                  <h3>No features to show yet</h3>\n                </td>\n              </tr>\n            )}\n          </tbody>\n          <tfoot>\n            <tr>\n              <th colSpan={2}>\n                <h4 className=\"subtotal-label\">TOTAL</h4>\n              </th>\n              <th>\n                <h4 className=\"subtotal\">\n                  {new Intl.NumberFormat('us', {\n                    style: 'currency',\n                    currency: 'USD',\n                  }).format(total)}\n                </h4>\n              </th>\n            </tr>\n          </tfoot>\n        </table>\n      </div>\n\n      <StatusBar message={message} messageType={messageType} />\n\n      <button onClick={handleClick}>\n        <h3>QUOTE</h3>\n      </button>\n    </>\n  );\n}\n\nexport default SelectionsComponent;\n","function StatusBar(props) {\n  const { message, messageType } = props;\n\n  return (\n    <>\n      {message && (\n        <div className={`status-bar card ${messageType}`}>\n          <span>{message}</span>\n        </div>\n      )}\n    </>\n  );\n}\n\nexport default StatusBar;\n"],"names":["LoadingComponent","createElement","React","useEffect","useState","useNavigate","useSelector","useDispatch","fetchServices","getClient","addSelections","calculateSelections","createQuote","finalizeQuote","getClientQuotes","StatusBar","SelectionsComponent","dispatch","messageType","setMessageType","message","setMessage","checkedItems","setCheckedItems","servicesLoading","services","state","user_email","stripe_customer_id","client","loading","quotes","quoteError","quote_id","status","selections","total","stripe_quote_id","quote","then","response","error","undefined","console","i","length","timestampNow","Math","floor","Date","now","timestamp","parseInt","expires_at","createdAt","expiresAt","log","id","cost","handleCheckboxChange","event","price_id","description","isChecked","target","checked","prevItems","newItem","filter","item","handleClick","window","location","href","Fragment","className","colSpan","map","service","key","type","name","some","onChange","Intl","NumberFormat","style","currency","format","onClick","props"],"sourceRoot":""}