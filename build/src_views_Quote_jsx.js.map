{"version":3,"file":"src_views_Quote_jsx.js","mappings":"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","sources":["webpack://orb-services/./src/views/Quote.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { useSelector, useDispatch } from 'react-redux';\n\nimport { fetchServices } from '../controllers/servicesSlice.js';\nimport { getClient } from '../controllers/clientSlice.js';\nimport {\n  addSelections,\n  calculateSelections,\n  getQuote,\n  updateQuote,\n  cancelQuote,\n  acceptQuote,\n  getStripeQuote,\n} from '../controllers/quoteSlice.js';\nimport { createInvoice, quoteToInvoice } from '../controllers/invoiceSlice.js';\n\nfunction QuoteComponent() {\n  const { id } = useParams();\n\n  const { loading, error, services } = useSelector((state) => state.services);\n  const { user_email, stripe_customer_id } = useSelector(\n    (state) => state.client\n  );\n  const { stripe_quote_id, status, total, selections, stripe_invoice_id } =\n    useSelector((state) => state.quote);\n  const { invoice_id } = useSelector((state) => state.invoice);\n  \n  const dispatch = useDispatch();\n  const navigate = useNavigate();\n\n  const [checkedItems, setCheckedItems] = useState([]);\n\n  useEffect(() => {\n    if (user_email) {\n      dispatch(getClient());\n    }\n  }, [user_email, dispatch]);\n\n  useEffect(() => {\n    if (stripe_customer_id) {\n      dispatch(fetchServices());\n    }\n  }, [stripe_customer_id, dispatch]);\n\n  useEffect(() => {\n    if (id && stripe_customer_id) {\n      dispatch(getQuote(id, stripe_customer_id));\n    }\n  }, [id, stripe_customer_id, dispatch]);\n\n  const handleCheckboxChange = (event, price_id, description, cost) => {\n    const isChecked = event.target.checked;\n\n    setCheckedItems((prevItems) => {\n      if (isChecked) {\n        const newItem = { price_id, description, cost };\n        return [...prevItems, newItem];\n      } else {\n        return prevItems.filter((item) => item.price_id !== price_id);\n      }\n    });\n  };\n\n  useEffect(() => {\n    dispatch(addSelections(checkedItems));\n  }, [dispatch, checkedItems]);\n\n  useEffect(() => {\n    dispatch(calculateSelections(services.cost));\n  }, [dispatch, services.cost, checkedItems]);\n\n  useEffect(() => {\n    if (selections) {\n      dispatch(quoteToInvoice(selections));\n    }\n  });\n\n  const handleCancel = () => {\n    if (status === 'draft' || status === 'open') {\n      dispatch(cancelQuote());\n    }\n  };\n\n  const handleConfirm = () => {\n    if (stripe_quote_id && status === 'open') {\n      dispatch(acceptQuote());\n    }\n  };\n\n  useEffect(() => {\n    if (status === 'accepted') {\n      dispatch(getStripeQuote());\n    }\n  }, [status, dispatch]);\n\n  useEffect(() => {\n    if (stripe_invoice_id) {\n      dispatch(createInvoice());\n    }\n  }, [stripe_invoice_id, dispatch]);\n\n  useEffect(() => {\n    if (invoice_id) {\n      navigate(`/services/invoice/${invoice_id}`);\n    }\n  }, [invoice_id, navigate]);\n\n  if (error) {\n    return (\n      <main className=\"error\">\n        <div className=\"status-bar card\">\n          <span className=\"error\">\n            There was an error loading the available services at this time.\n          </span>\n        </div>\n      </main>\n    );\n  }\n\n  if (loading) {\n    return <div>Loading...</div>;\n  }\n\n  return (\n    <>\n      <h2>QUOTE</h2>\n\n      <div className=\"quote-card card\">\n        <table>\n          <thead>\n            <tr>\n              <th colSpan={2}>\n                <h4 className=\"description-label\">DESCRIPTION</h4>\n              </th>\n              <th>\n                <h4 className=\"cost-label\">COST</h4>\n              </th>\n            </tr>\n          </thead>\n          <tbody>\n            {services && services.length ? (\n              <React.Fragment>\n                {services.map((service) => {\n                  const { price_id, description, cost } = service;\n\n                  return (\n                    <tr key={price_id} id=\"quote_option\">\n                      <td>\n                        <input\n                          className=\"input selection feature-selection\"\n                          type=\"checkbox\"\n                          name=\"quote[checkbox][]\"\n                          checked={checkedItems.some(\n                            (item) => item.price_id === price_id\n                          )}\n                          onChange={(event) =>\n                            handleCheckboxChange(\n                              event,\n                              price_id,\n                              description,\n                              cost\n                            )\n                          }\n                        />\n                      </td>\n                      <td className=\"feature-description\">{description}</td>\n                      <td\n                        className=\"feature-cost table-number\"\n                        id=\"feature_cost\">\n                        {new Intl.NumberFormat('us', {\n                          style: 'currency',\n                          currency: 'USD',\n                        }).format(cost)}\n                      </td>\n                    </tr>\n                  );\n                })}\n              </React.Fragment>\n            ) : (\n              <tr>\n                <td colSpan={3}>\n                  <h3>No features to show yet</h3>\n                </td>\n              </tr>\n            )}\n          </tbody>\n          <tfoot>\n            <tr>\n              <th colSpan={2}>\n                <h4 className=\"subtotal-label\">TOTAL</h4>\n              </th>\n              <th>\n                <h4 className=\"subtotal\">\n                  {new Intl.NumberFormat('us', {\n                    style: 'currency',\n                    currency: 'USD',\n                  }).format(total)}\n                </h4>\n              </th>\n            </tr>\n          </tfoot>\n        </table>\n      </div>\n\n      <div className=\"actions\">\n        <button onClick={handleCancel}>\n          <h3>CANCEL</h3>\n        </button>\n        <button onClick={handleConfirm}>\n          <h3>CONFIRM</h3>\n        </button>\n      </div>\n    </>\n  );\n}\n\nexport default QuoteComponent;\n"],"names":["React","useEffect","useState","useNavigate","useParams","useSelector","useDispatch","fetchServices","getClient","addSelections","calculateSelections","getQuote","updateQuote","cancelQuote","acceptQuote","getStripeQuote","createInvoice","quoteToInvoice","QuoteComponent","id","loading","error","services","state","user_email","stripe_customer_id","client","stripe_quote_id","status","total","selections","stripe_invoice_id","quote","invoice_id","invoice","dispatch","navigate","checkedItems","setCheckedItems","handleCheckboxChange","event","price_id","description","cost","isChecked","target","checked","prevItems","newItem","filter","item","handleCancel","handleConfirm","createElement","className","Fragment","colSpan","length","map","service","key","type","name","some","onChange","Intl","NumberFormat","style","currency","format","onClick"],"sourceRoot":""}