{"version":3,"file":"src_views_BillingQuote_jsx.js","mappings":"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","sources":["webpack://orb-services/./src/views/BillingQuote.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { useSelector, useDispatch } from 'react-redux';\n\nimport { fetchServices } from '../controllers/servicesSlice.js';\nimport { getClient } from '../controllers/clientSlice.js';\nimport {\n  cancelQuote,\n  acceptQuote,\n  getStripeQuote,\n  getQuoteByID,\n} from '../controllers/quoteSlice.js';\nimport { saveInvoice } from '../controllers/invoiceSlice.js';\n\nfunction QuoteComponent() {\n  const { id } = useParams();\n\n  const { services } = useSelector((state) => state.services);\n  const { user_email, stripe_customer_id } = useSelector(\n    (state) => state.client\n  );\n  const {\n    loading,\n    quoteError,\n    quote_id,\n    stripe_quote_id,\n    status,\n    total,\n    selections,\n    stripe_invoice_id,\n  } = useSelector((state) => state.quote);\n  const { invoice_id } = useSelector((state) => state.invoice);\n\n  const dispatch = useDispatch();\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    if (user_email) {\n      dispatch(getClient());\n    }\n  }, [user_email, dispatch]);\n\n  useEffect(() => {\n    if (stripe_customer_id) {\n      dispatch(fetchServices());\n    }\n  }, [stripe_customer_id, dispatch]);\n\n  useEffect(() => {\n    if (id && stripe_customer_id) {\n      dispatch(getQuoteByID(id));\n    }\n  }, [id, stripe_customer_id, dispatch]);\n\n  const handleCancel = () => {\n    if (stripe_quote_id && status === 'open') {\n      dispatch(cancelQuote());\n    }\n  };\n\n  const handleConfirm = async () => {\n    if (stripe_quote_id && status === 'open') {\n      await dispatch(acceptQuote()).then(() => {\n        return dispatch(getStripeQuote());\n      });\n    }\n  };\n\n  const handleAccepted = () => {\n    if (stripe_quote_id && quote_id && status === 'accepted') {\n      navigate(`/billing/invoice/${quote_id}`);\n    }\n  };\n\n  useEffect(() => {\n    if (stripe_invoice_id) {\n      dispatch(saveInvoice());\n    }\n  }, [stripe_invoice_id, dispatch]);\n\n  useEffect(() => {\n    if (status === 'accepted' && stripe_invoice_id && invoice_id)\n      navigate(`/billing/invoice/${invoice_id}`);\n  }, [status, stripe_invoice_id, invoice_id]);\n\n  if (status === 'canceled') {\n    return (\n      <main>\n        <div className=\"status-bar card error\">\n          <span className=\"error\">This quote has been canceled.</span>\n        </div>\n      </main>\n    );\n  }\n\n  if (quoteError) {\n    return (\n      <div className=\"status-bar card error\">\n        <span>\n          <h4>{quoteError}</h4>\n        </span>\n      </div>\n    );\n  }\n\n  if (loading) {\n    return <div>Loading...</div>;\n  }\n\n  return (\n    <>\n      <h2 className=\"title\">QUOTE</h2>\n      <div className=\"quote-card card\">\n        <table>\n          <thead>\n            <tr>\n              <th>\n                <h4>Quote</h4>\n              </th>\n            </tr>\n            <tr>\n              <th>\n                <h4 className=\"number-label\">NO.</h4>\n              </th>\n              <th colSpan={4}>\n                <h4 className=\"description-label\">DESCRIPTION</h4>\n              </th>\n              <th>\n                <h4 className=\"total-label\">TOTAL</h4>\n              </th>\n            </tr>\n          </thead>\n          <tbody>\n            {selections &&\n              selections.length > 0 &&\n              selections.map((item) => (\n                <tr id=\"quote_option\">\n                  <td className=\"feature-id\">{item.id}</td>\n                  <td className=\"feature-name\" id=\"feature_name\" colSpan={4}>\n                    {item.description}\n                  </td>\n                  <td className=\"feature-cost  table-number\" id=\"feature_cost\">\n                    <h4>\n                      {new Intl.NumberFormat('us', {\n                        style: 'currency',\n                        currency: 'USD',\n                      }).format(item.cost)}\n                    </h4>\n                  </td>\n                </tr>\n              ))}\n          </tbody>\n        </table>\n      </div>\n      <div className=\"actions\">\n        {status && status === 'open' ? (\n          <>\n            <button onClick={handleCancel}>\n              <h3>CANCEL</h3>\n            </button>\n\n            <button onClick={handleConfirm}>\n              <h3>CONFIRM</h3>\n            </button>\n          </>\n        ) : status === 'accepted' ? (\n          <button onClick={handleAccepted}>\n            <h3>INVOICE</h3>\n          </button>\n        ) : null}\n      </div>\n    </>\n  );\n}\n\nexport default QuoteComponent;\n"],"names":["React","useEffect","useState","useNavigate","useParams","useSelector","useDispatch","fetchServices","getClient","cancelQuote","acceptQuote","getStripeQuote","getQuoteByID","saveInvoice","QuoteComponent","id","services","state","user_email","stripe_customer_id","client","loading","quoteError","quote_id","stripe_quote_id","status","total","selections","stripe_invoice_id","quote","invoice_id","invoice","dispatch","navigate","handleCancel","handleConfirm","then","handleAccepted","createElement","className","Fragment","colSpan","length","map","item","description","Intl","NumberFormat","style","currency","format","cost","onClick"],"sourceRoot":""}